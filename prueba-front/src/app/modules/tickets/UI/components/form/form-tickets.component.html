<!-- Dialog para Crear/Editar Ticket -->
<p-dialog
  [(visible)]="displayModal"
  [header]="isEditMode ? 'Editar Ticket' : 'Crear Nuevo Ticket'"
  [modal]="true"
  [closable]="true"
  [draggable]="false"
  [resizable]="false"
  styleClass="p-fluid modern-dialog"
  [style]="{ width: '600px', maxHeight: '90vh' }"
>
  <div class="form-container">
    <form [formGroup]="frmTicket" (ngSubmit)="buildsaveTicket()">
      
      <!-- Tipo de Ticket -->
      <div class="field">
        <label for="type">
          <i class="pi pi-tag mr-2"></i>
          Tipo de Ticket
        </label>
        <input
          type="text"
          pInputText
          id="type"
          formControlName="type"
          placeholder="Ej: Soporte técnico, Consulta, Reclamo..."
          [class.ng-invalid]="frmTicket.get('type')?.invalid && frmTicket.get('type')?.touched"
          [class.ng-dirty]="frmTicket.get('type')?.touched"
          class="form-input"
        />
        <small class="p-error" *ngIf="frmTicket.get('type')?.invalid && frmTicket.get('type')?.touched">
          Este campo es obligatorio
        </small>
      </div>

      <!-- Prioridad -->
      <div class="field">
        <label for="priority">
          <i class="pi pi-exclamation-triangle mr-2"></i>
          Prioridad
        </label>
        <p-dropdown
          id="priority"
          formControlName="priority"
          [options]="[
            { label: 'Baja', value: 1 },
            { label: 'Media', value: 2 },
            { label: 'Alta', value: 3 },
            { label: 'Crítica', value: 4 }
          ]"
          appendTo="body"
          placeholder="Seleccione la prioridad"
          [class.ng-invalid]="frmTicket.get('priority')?.invalid && frmTicket.get('priority')?.touched"
          [class.ng-dirty]="frmTicket.get('priority')?.touched"
          class="form-dropdown"
        ></p-dropdown>
        <small class="p-error" *ngIf="frmTicket.get('priority')?.invalid && frmTicket.get('priority')?.touched">
          Este campo es obligatorio
        </small>
      </div>

      <!-- Fecha de Creación -->
      <div class="field">
        <label for="date_creation">
          <i class="pi pi-calendar mr-2"></i>
          Fecha de Creación
        </label>
        <p-calendar
          id="date_creation"
          formControlName="date_creation"
          dateFormat="yy-mm-dd"
          [showIcon]="true"
          [showTime]="true"
          appendTo="body"
          placeholder="Seleccionar fecha y hora"
          [class.ng-invalid]="frmTicket.get('date_creation')?.invalid && frmTicket.get('date_creation')?.touched"
          [class.ng-dirty]="frmTicket.get('date_creation')?.touched"
          class="form-input"
        ></p-calendar>
        <small class="p-error" *ngIf="frmTicket.get('date_creation')?.invalid && frmTicket.get('date_creation')?.touched">
          Este campo es obligatorio
        </small>
      </div>

    </form>
  </div>

  <!-- Footer del dialog -->
  <ng-template pTemplate="footer">
    <div class="dialog-footer">
      <p-button
        label="Cancelar"
        icon="pi pi-times"
        severity="secondary"
        (onClick)="closeModal()"
        [disabled]="isSubmitting"
        class="cancel-button"
      ></p-button>
      <p-button
        label="Limpiar"
        icon="pi pi-refresh"
        severity="warning"
        [outlined]="true"
        (onClick)="resetForm()"
        [disabled]="isSubmitting"
        class="reset-button"
      ></p-button>
      <p-button
        [label]="isEditMode ? 'Actualizar' : 'Guardar'"
        [icon]="isEditMode ? 'pi pi-check' : 'pi pi-save'"
        [loading]="isSubmitting"
        [disabled]="frmTicket.invalid"
        class="save-button"
        (onClick)="buildsaveTicket()"
      ></p-button>
    </div>
  </ng-template>
</p-dialog>

<p-toast></p-toast>